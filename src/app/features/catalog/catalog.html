<div class="catalog-wrapper">
    <!-- Hero Section -->
    <header class="catalog-hero">
        <div class="container hero-inner">
            <div class="hero-text">
                <h1>{{ currentCategory ? (getCategoryName()) : 'The Entire Collection' }}</h1>
                <p>{{ totalProducts() }} Masterpieces Curated for Excellence</p>
            </div>
            <div class="catalog-search">
                <input type="text" [(ngModel)]="searchQuery" (keyup.enter)="onSearch()"
                    placeholder="Search by collection or designer...">
                <button (click)="onSearch()" class="search-btn">üîç</button>
            </div>
        </div>
    </header>

    <div class="catalog-layout container">
        <!-- Sidebar Filter (Mobile Friendly) -->
        <aside class="catalog-sidebar">
            <div class="sidebar-section">
                <h3>Categories</h3>
                <div class="filter-pills">
                    <a [routerLink]="['/products']" [queryParams]="{ search: searchQuery }"
                        [class.active]="!currentCategory" class="pill-link">
                        <span class="dot"></span> All Items
                    </a>
                    <a *ngFor="let cat of categories()" [routerLink]="['/products']"
                        [queryParams]="{ category: cat._id, search: searchQuery }"
                        [class.active]="currentCategory === cat._id" class="pill-link">
                        <span class="dot"></span> {{ cat.name }}
                    </a>
                </div>
            </div>
        </aside>

        <!-- Main Workspace -->
        <main class="catalog-main">
            <div *ngIf="isLoading()" class="glass-loader">
                <div class="pulse-loader"></div>
                <p>Aligning the Stars...</p>
            </div>

            <div *ngIf="!isLoading() && products().length > 0" class="products-container">
                <div class="grid-animation-wrapper">
                    <app-product-card *ngFor="let product of products()" [product]="product"
                        (addToCart)="handleAddToCart($event)">
                    </app-product-card>
                </div>
            </div>

            <div *ngIf="!isLoading() && products().length === 0" class="not-found-state">
                <div class="empty-icon">üß•</div>
                <h2>Nothing matches your search</h2>
                <p>Try refining your filters or view the full range.</p>
                <button class="clear-btn" (click)="searchQuery = ''; onSearch()">Clear All</button>
            </div>

            <!-- Enhanced Pagination -->
            <footer class="catalog-footer" *ngIf="totalPages() > 1 && !isLoading()">
                <div class="pagination-rack">
                    <a *ngFor="let p of getPages()" [routerLink]="['/products']"
                        [queryParams]="{ category: currentCategory, search: searchQuery, page: p }"
                        [class.active]="p === currentPage()" class="page-control">
                        {{ p < 10 ? '0' + p : p }} </a>
                </div>
            </footer>
        </main>
    </div>
</div>